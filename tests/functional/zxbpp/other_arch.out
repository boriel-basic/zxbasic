#line 1 "other_arch.bi"
#line 1 "/zxbasic/src/lib/arch/zx48k/stdlib/attr.bas"











#line 13 "/zxbasic/src/lib/arch/zx48k/stdlib/attr.bas"

#pragma push(case_insensitive)
#pragma case_insensitive = TRUE











function attr(byval row as ubyte, byval col as ubyte) as ubyte
    asm
    push namespace core

    PROC
    LOCAL __ATTR_END

    ld e, (ix+7)
    ld d, (ix+5)

    
    call __IN_SCREEN
    jr nc, __ATTR_END

    call __ATTR_ADDR
    ld a, (hl)	

__ATTR_END:
    ENDP

    pop namespace
    end asm

end function














sub setattr(byval row as ubyte, byval col as ubyte, byval value as ubyte)
    asm
    push namespace core

    PROC
    LOCAL __ATTR_END

    ld e, (ix+7)
    ld d, (ix+5)

    
    call __IN_SCREEN
    jr nc, __ATTR_END

    call __ATTR_ADDR
    ld a, (ix+9)
    ld (hl), a	

__ATTR_END:
    ENDP

    pop namespace
    end asm

end sub











function fastcall attraddr(byval row as ubyte, byval col as ubyte) as uinteger
    asm
    push namespace core
    
    pop hl         
    ex (sp), hl    
    ld d, a        
    ld e, h
    jp __ATTR_ADDR 
    pop namespace
    end asm
end function



#pragma pop(case_insensitive)


#require "attr.asm"


#require "in_screen.asm"

#line 125 "/zxbasic/src/lib/arch/zx48k/stdlib/attr.bas"
#line 2 "other_arch.bi"
#line 1 "/zxbasic/src/lib/arch/zxnext/stdlib/hex.bas"







#line 1 "/zxbasic/src/lib/arch/zx48k/stdlib/hex.bas"











#line 13 "/zxbasic/src/lib/arch/zx48k/stdlib/hex.bas"

#pragma push(case_insensitive)
#pragma case_insensitive = TRUE

#pragma push(string_base)
#pragma string_base = 0










function FASTCALL hex(num as ULong) as String
	asm
    push namespace core
    PROC
    LOCAL SUB_CHAR
    LOCAL SUB_CHAR2
    LOCAL END_CHAR
    LOCAL DIGIT

    push hl
    push de
    ld bc,10
    call __MEM_ALLOC
    ld a, h
    or l
    pop de
    pop bc
    ret z	

    push hl	
    ld (hl), 8
    inc hl
    ld (hl), 0
    inc hl  

    call DIGIT
    ld d, e
    call DIGIT
    ld d, b
    call DIGIT
    ld d, c
    call DIGIT
    pop hl	
    ret

DIGIT:
    ld a, d
    call SUB_CHAR
    ld a, d
    jr SUB_CHAR2

SUB_CHAR:
    rrca
    rrca
    rrca
    rrca

SUB_CHAR2:
    and 0Fh
    add a, '0'
    cp '9' + 1
    jr c, END_CHAR
    add a, 7

END_CHAR:
    ld (hl), a
    inc hl
    ret

    ENDP
    pop namespace
	end asm
end function



function hex16(n as UInteger) as String
	Dim a$ as String
	a$ = hex(n)
	return a$(4 TO 7)
end function



Function hex8 (n as UByte) as String
  Dim res$ as String

	res$ = hex(n)
	return res$(6 TO 7)
end function


#pragma pop(string_base)
#pragma pop(case_insensitive)


#require "mem/alloc.asm"

#line 118 "/zxbasic/src/lib/arch/zx48k/stdlib/hex.bas"
#line 9 "/zxbasic/src/lib/arch/zxnext/stdlib/hex.bas"
#line 3 "other_arch.bi"
